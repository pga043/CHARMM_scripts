* extract different segments to be used for MSLD
* or NAMD FEP
* 

set dir = ..
set prot = false

! read topology and parameter files
stream toppar.str

read psf card name ../8qer_complex-neutralized.psf
read coor card name ../8qer_complex-finalmini.crd

define proa sele segid PROA end
define prob sele segid PROB end
define ligs sele segid LIG* end
define heta sele resname tip3 .or. resname pot .or. resname cla end

if @prot .eq. true then
bomlev -1
delete atom sele .not. proa end
bomlev 0

write psf card name proa.psf
write coor card name proa.crd
write coor pdb name proa.pdb

else

bomlev -1
delete atom sele proa end
!delete atom sele segid LIGA show end
bomlev 0

set out = no_proa
!set out = no_proa_liga

if @out .eq. no_proa_liga then
!! remove a randomly chosen counter ion
!! in this case LIGA has -1 so, it has to be a POT ion
delete atom sele segid POT .and. resid 40 show end
endif

write psf card name @{out}.psf
write coor card name @{out}.crd
write coor pdb name @{out}.pdb

endif

stop

